{% extends 'api/base.html' %}

{% block title %}Protótipo · Emissão de Certificados{% endblock %}

{% block content %}
<section class="prototype-hero">
    <h1>Emissão de certificados</h1>
    <p>Organizadores ou administradores selecionam uma inscrição confirmada com presença validada para gerar o certificado correspondente.</p>
</section>

<section class="prototype-grid">
    <article class="prototype-card">
        <span class="badge">Emitir certificado</span>
        <form method="post">
            {% csrf_token %}
            {% if form_errors %}
                <div class="alert alert-error">
                    <ul>
                        {% for error in form_errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
            {% if form_success %}
                <div class="alert alert-success">{{ form_success }}</div>
            {% endif %}
            <div class="form-group">
                <label for="cert-inscricao">Inscrição elegível</label>
                <select id="cert-inscricao" name="inscricao">
                    <option value="">Selecionar inscrição</option>
                    {% for inscricao in inscricoes_elegiveis %}
                        <option value="{{ inscricao.pk }}" {% if form_data.inscricao == inscricao.pk|stringformat:"s" %}selected{% endif %}>
                            {{ inscricao.participante.nome }} · {{ inscricao.evento.get_tipo_display }} · {{ inscricao.evento.data_inicio|date:"d/m/Y" }}
                        </option>
                    {% empty %}
                        <option value="" disabled>Nenhuma inscrição com presença confirmada encontrada</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="cert-carga">Carga horária (h)</label>
                <input id="cert-carga" name="carga_horaria" type="number" min="1" value="{{ form_data.carga_horaria|default:4 }}">
            </div>
            <div class="form-group">
                <label for="cert-emitido-por">Emitido por</label>
                <select id="cert-emitido-por" name="emitido_por">
                    <option value="">Selecionar emissor</option>
                    {% for emissor in emissores %}
                        <option value="{{ emissor.pk }}" {% if form_data.emitido_por == emissor.pk|stringformat:"s" %}selected{% endif %}>
                            {{ emissor.nome }} · {{ emissor.get_perfil_display }}
                        </option>
                    {% empty %}
                        <option value="" disabled>Nenhum emissor autorizado disponível</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="cert-validade">Validade</label>
                <input id="cert-validade" name="validade" type="date" value="{{ form_data.validade|default:'' }}">
            </div>
            <div class="form-group">
                <label for="cert-observacoes">Observações</label>
                <textarea id="cert-observacoes" name="observacoes" placeholder="Notas adicionais sobre a participação.">{{ form_data.observacoes|default:'' }}</textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn primary">Emitir certificado</button>
                <button type="button" class="btn secondary">Reenviar por e-mail</button>
            </div>
        </form>
    </article>
</section>
{% endblock %}
