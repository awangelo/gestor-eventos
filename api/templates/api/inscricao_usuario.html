{% extends 'api/base.html' %}

{% block title %}Protótipo · Inscrição de Usuários{% endblock %}

{% block content %}
<section class="prototype-hero">
    <h1>Inscrição de usuários em eventos</h1>
    <p>Pessoas com perfil de aluno ou professor escolhem um evento disponível, verificam vagas e confirmam a inscrição.</p>
</section>

<section class="prototype-grid">
    <article class="prototype-card">
        <span class="badge">Seleção do evento</span>
        <form method="post">
            {% csrf_token %}
            {% if form_errors %}
                <div class="alert alert-error">
                    <ul>
                        {% for error in form_errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
            {% if form_success %}
                <div class="alert alert-success">{{ form_success }}</div>
            {% endif %}
            <div class="form-group">
                <label for="inscricao-evento">Evento</label>
                <select id="inscricao-evento" name="evento">
                    <option value="">Escolha um evento</option>
                    {% for evento in eventos %}
                        <option value="{{ evento.pk }}" {% if form_data.evento == evento.pk|stringformat:"s" %}selected{% endif %}>
                            {{ evento.get_tipo_display }} · {{ evento.data_inicio|date:"d/m" }}
                            {% if evento.data_fim and evento.data_fim != evento.data_inicio %}
                                a {{ evento.data_fim|date:"d/m" }}
                            {% endif %}
                            · {{ evento.local }} · Vagas: {{ evento.vagas_disponiveis }}
                        </option>
                    {% empty %}
                        <option value="" disabled>Nenhum evento disponível</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="inscricao-usuario">Participante</label>
                <select id="inscricao-usuario" name="participante">
                    <option value="">Selecionar usuário</option>
                    {% for participante in participantes %}
                        <option value="{{ participante.pk }}" {% if form_data.participante == participante.pk|stringformat:"s" %}selected{% endif %}>
                            {{ participante.nome }} · {{ participante.get_perfil_display }}
                            {% if participante.instituicao %}
                                · {{ participante.get_instituicao_display|default:participante.instituicao }}
                            {% endif %}
                        </option>
                    {% empty %}
                        <option value="" disabled>Nenhum participante elegível encontrado</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="inscricao-status">Status</label>
                <select id="inscricao-status" name="status">
                    {% for value, label in status_inscricao %}
                        <option value="{{ value }}" {% if form_data.status == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" name="presenca_confirmada" {% if form_data.presenca_confirmada %}checked{% endif %}> Presença confirmada
                </label>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn primary">Atualizar inscrição</button>
                <button type="button" class="btn secondary">Cancelar inscrição</button>
            </div>
        </form>
    </article>
</section>
{% endblock %}
